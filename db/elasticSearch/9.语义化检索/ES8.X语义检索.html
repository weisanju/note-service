<!DOCTYPE HTML>
<html lang="zh_CN" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>ES8.X语义检索.md - DB笔记</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item "><a href="../../MongoDB/README.html"><strong aria-hidden="true">0.</strong> MongoDB</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../MongoDB/mongodb基本操作.html"><strong aria-hidden="true">0.0.</strong> mongodb基本操作.md</a></li><li class="chapter-item "><a href="../../MongoDB/mongodb高级语法.html"><strong aria-hidden="true">0.1.</strong> mongodb高级语法.md</a></li><li class="chapter-item "><a href="../../MongoDB/权限管理.html"><strong aria-hidden="true">0.2.</strong> 权限管理.md</a></li></ol></li><li class="chapter-item expanded "><a href="../../elasticSearch/README.html"><strong aria-hidden="true">1.</strong> elasticSearch</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../elasticSearch/9.html"><strong aria-hidden="true">1.0.</strong> 语义化检索</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../elasticSearch/9.语义化检索/ES8.X语义检索.html" class="active"><strong aria-hidden="true">1.0.0.</strong> ES8.X语义检索.md</a></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/BackUpACluster.html"><strong aria-hidden="true">1.1.</strong> BackUpACluster.md</a></li><li class="chapter-item "><a href="../../elasticSearch/IngestPipeline.html"><strong aria-hidden="true">1.2.</strong> IngestPipeline</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/IngestPipeline/1.IngestPipelines.html"><strong aria-hidden="true">1.2.0.</strong> IngestPipelines.md</a></li><li class="chapter-item "><a href="../../elasticSearch/IngestPipeline/2.pipeLineExample.html"><strong aria-hidden="true">1.2.1.</strong> pipeLineExample.md</a></li><li class="chapter-item "><a href="../../elasticSearch/IngestPipeline/3.EnrichYourData.html"><strong aria-hidden="true">1.2.2.</strong> EnrichYourData.md</a></li><li class="chapter-item "><a href="../../elasticSearch/IngestPipeline/4.ExampleEnrichYourDataBasedOnGeolocation.html"><strong aria-hidden="true">1.2.3.</strong> ExampleEnrichYourDataBasedOnGeolocation.md</a></li><li class="chapter-item "><a href="../../elasticSearch/IngestPipeline/5.IngestProcessorReference.html"><strong aria-hidden="true">1.2.4.</strong> IngestProcessorReference.md</a></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/KQL.html"><strong aria-hidden="true">1.3.</strong> KQL.md</a></li><li class="chapter-item "><a href="../../elasticSearch/安装/README.html"><strong aria-hidden="true">1.4.</strong> 安装</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/安装/1.InstallingFromRpm.html"><strong aria-hidden="true">1.4.0.</strong> InstallingFromRpm.md</a></li><li class="chapter-item "><a href="../../elasticSearch/安装/2.InstallFromDeb.html"><strong aria-hidden="true">1.4.1.</strong> InstallFromDeb.md</a></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/6.DataStreams/README.html"><strong aria-hidden="true">1.5.</strong> DataStreams</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/6.DataStreams/1.setUpADataStream.html"><strong aria-hidden="true">1.5.0.</strong> setUpADataStream.md</a></li><li class="chapter-item "><a href="../../elasticSearch/6.DataStreams/2.UseADataStream.html"><strong aria-hidden="true">1.5.1.</strong> UseADataStream.md</a></li><li class="chapter-item "><a href="../../elasticSearch/6.DataStreams/3.ChangeMappingsAndSettings.html"><strong aria-hidden="true">1.5.2.</strong> ChangeMappingsAndSettings.md</a></li><li class="chapter-item "><a href="../../elasticSearch/6.DataStreams/DataStreams.mm.html"><strong aria-hidden="true">1.5.3.</strong> DataStreams.mm.md</a></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/README.html"><strong aria-hidden="true">1.6.</strong> Mapping</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/Mapping.mm.html"><strong aria-hidden="true">1.6.0.</strong> Mapping.mm.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/4.FieldDataTypes/README.html"><strong aria-hidden="true">1.6.1.</strong> FieldDataTypes</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/4.FieldDataTypes/1.AggregateMetric.html"><strong aria-hidden="true">1.6.1.0.</strong> AggregateMetric.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/4.FieldDataTypes/10.GeoPoint.html"><strong aria-hidden="true">1.6.1.1.</strong> GeoPoint.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/4.FieldDataTypes/11.Geo-shape.html"><strong aria-hidden="true">1.6.1.2.</strong> Geo-shape.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/4.FieldDataTypes/12.Histogram.html"><strong aria-hidden="true">1.6.1.3.</strong> Histogram.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/4.FieldDataTypes/13.IP.html"><strong aria-hidden="true">1.6.1.4.</strong> IP.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/4.FieldDataTypes/14.Join.html"><strong aria-hidden="true">1.6.1.5.</strong> Join.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/4.FieldDataTypes/15.KeywordType.html"><strong aria-hidden="true">1.6.1.6.</strong> KeywordType.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/4.FieldDataTypes/16.Object.html"><strong aria-hidden="true">1.6.1.7.</strong> Object.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/4.FieldDataTypes/17.Nested.html"><strong aria-hidden="true">1.6.1.8.</strong> Nested.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/4.FieldDataTypes/18.Numberic.html"><strong aria-hidden="true">1.6.1.9.</strong> Numberic.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/4.FieldDataTypes/19.Percolator.html"><strong aria-hidden="true">1.6.1.10.</strong> Percolator.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/4.FieldDataTypes/2.AliasFieldType.html"><strong aria-hidden="true">1.6.1.11.</strong> AliasFieldType.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/4.FieldDataTypes/20.Point.html"><strong aria-hidden="true">1.6.1.12.</strong> Point.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/4.FieldDataTypes/21.Range.html"><strong aria-hidden="true">1.6.1.13.</strong> Range.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/4.FieldDataTypes/22.RankFeature.html"><strong aria-hidden="true">1.6.1.14.</strong> RankFeature.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/4.FieldDataTypes/23.RankFeatures.html"><strong aria-hidden="true">1.6.1.15.</strong> RankFeatures.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/4.FieldDataTypes/24.Search-as-you-type.html"><strong aria-hidden="true">1.6.1.16.</strong> Search-as-you-type.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/4.FieldDataTypes/25.Shape.html"><strong aria-hidden="true">1.6.1.17.</strong> Shape.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/4.FieldDataTypes/26.Text.html"><strong aria-hidden="true">1.6.1.18.</strong> Text.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/4.FieldDataTypes/27.TokenCount.html"><strong aria-hidden="true">1.6.1.19.</strong> TokenCount.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/4.FieldDataTypes/28.UnsignedLong.html"><strong aria-hidden="true">1.6.1.20.</strong> UnsignedLong.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/4.FieldDataTypes/29.Version.html"><strong aria-hidden="true">1.6.1.21.</strong> Version.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/4.FieldDataTypes/3.Arrays.html"><strong aria-hidden="true">1.6.1.22.</strong> Arrays.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/4.FieldDataTypes/4.Binary.html"><strong aria-hidden="true">1.6.1.23.</strong> Binary.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/4.FieldDataTypes/5.Boolean.html"><strong aria-hidden="true">1.6.1.24.</strong> Boolean.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/4.FieldDataTypes/6.Date.html"><strong aria-hidden="true">1.6.1.25.</strong> Date.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/4.FieldDataTypes/7.DateNanoseconds.html"><strong aria-hidden="true">1.6.1.26.</strong> DateNanoseconds.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/4.FieldDataTypes/8.DenseVector.html"><strong aria-hidden="true">1.6.1.27.</strong> DenseVector.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/4.FieldDataTypes/9.Flattened.html"><strong aria-hidden="true">1.6.1.28.</strong> Flattened.md</a></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/7.MappingLimitSettings/README.html"><strong aria-hidden="true">1.6.2.</strong> MappingLimitSettings</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/2.ExplicitMapping/README.html"><strong aria-hidden="true">1.6.3.</strong> ExplicitMapping</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/8.RemovalOfMappingTypes/README.html"><strong aria-hidden="true">1.6.4.</strong> RemovalOfMappingTypes</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/1.DynamicMapping/README.html"><strong aria-hidden="true">1.6.5.</strong> DynamicMapping</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/1.DynamicMapping/1.DynamicFieldMapping.html"><strong aria-hidden="true">1.6.5.0.</strong> DynamicFieldMapping.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/1.DynamicMapping/2.DynamicTemplates.html"><strong aria-hidden="true">1.6.5.1.</strong> DynamicTemplates.md</a></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/6.MappingParameters/README.html"><strong aria-hidden="true">1.6.6.</strong> MappingParameters</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/6.MappingParameters/1.Analyzer.html"><strong aria-hidden="true">1.6.6.0.</strong> Analyzer.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/6.MappingParameters/10.IgnoreAbove.html"><strong aria-hidden="true">1.6.6.1.</strong> IgnoreAbove.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/6.MappingParameters/11.IgnoreMalformed.html"><strong aria-hidden="true">1.6.6.2.</strong> IgnoreMalformed.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/6.MappingParameters/12.index.html"><strong aria-hidden="true">1.6.6.3.</strong> index.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/6.MappingParameters/13.IndexOptions.html"><strong aria-hidden="true">1.6.6.4.</strong> IndexOptions.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/6.MappingParameters/14.indexPharse.html"><strong aria-hidden="true">1.6.6.5.</strong> indexPharse.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/6.MappingParameters/15.indexPrefixes.html"><strong aria-hidden="true">1.6.6.6.</strong> indexPrefixes.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/6.MappingParameters/16.meta.html"><strong aria-hidden="true">1.6.6.7.</strong> meta.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/6.MappingParameters/17.multifileds.html"><strong aria-hidden="true">1.6.6.8.</strong> multifileds.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/6.MappingParameters/18.normalizer.html"><strong aria-hidden="true">1.6.6.9.</strong> normalizer.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/6.MappingParameters/19.norms.html"><strong aria-hidden="true">1.6.6.10.</strong> norms.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/6.MappingParameters/2.boost.html"><strong aria-hidden="true">1.6.6.11.</strong> boost.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/6.MappingParameters/20.nullValue.html"><strong aria-hidden="true">1.6.6.12.</strong> nullValue.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/6.MappingParameters/21.positionIncrementGap.html"><strong aria-hidden="true">1.6.6.13.</strong> positionIncrementGap.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/6.MappingParameters/22.properties.html"><strong aria-hidden="true">1.6.6.14.</strong> properties.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/6.MappingParameters/23.searchAnalyzer.html"><strong aria-hidden="true">1.6.6.15.</strong> searchAnalyzer.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/6.MappingParameters/24.similarity.html"><strong aria-hidden="true">1.6.6.16.</strong> similarity.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/6.MappingParameters/25.store.html"><strong aria-hidden="true">1.6.6.17.</strong> store.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/6.MappingParameters/26.termVector.html"><strong aria-hidden="true">1.6.6.18.</strong> termVector.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/6.MappingParameters/3.coerce.html"><strong aria-hidden="true">1.6.6.19.</strong> coerce.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/6.MappingParameters/4.CopyTo.html"><strong aria-hidden="true">1.6.6.20.</strong> CopyTo.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/6.MappingParameters/5.DocValue.html"><strong aria-hidden="true">1.6.6.21.</strong> DocValue.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/6.MappingParameters/6.dynamic.html"><strong aria-hidden="true">1.6.6.22.</strong> dynamic.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/6.MappingParameters/7.eagerGlobalOrdinals.html"><strong aria-hidden="true">1.6.6.23.</strong> eagerGlobalOrdinals.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/6.MappingParameters/8.enabled.html"><strong aria-hidden="true">1.6.6.24.</strong> enabled.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/6.MappingParameters/9.format.html"><strong aria-hidden="true">1.6.6.25.</strong> format.md</a></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/3.RuntimeFields/README.html"><strong aria-hidden="true">1.6.7.</strong> RuntimeFields</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/3.RuntimeFields/1.MapARuntimeField.html"><strong aria-hidden="true">1.6.7.0.</strong> MapARuntimeField.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/3.RuntimeFields/2.DefineRuntimeFieldsInASearchRequest.html"><strong aria-hidden="true">1.6.7.1.</strong> DefineRuntimeFieldsInASearchRequest.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/3.RuntimeFields/3.OverrideFieldValuesAtQueryTime.html"><strong aria-hidden="true">1.6.7.2.</strong> OverrideFieldValuesAtQueryTime.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/3.RuntimeFields/4.RetrieveARuntimeField.html"><strong aria-hidden="true">1.6.7.3.</strong> RetrieveARuntimeField.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/3.RuntimeFields/5.IndexARuntimeField.html"><strong aria-hidden="true">1.6.7.4.</strong> IndexARuntimeField.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/3.RuntimeFields/6.ExploreYourDataWithRuntimeFields.html"><strong aria-hidden="true">1.6.7.5.</strong> ExploreYourDataWithRuntimeFields.md</a></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/5.MetadataFields/README.html"><strong aria-hidden="true">1.6.8.</strong> MetadataFields</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/5.MetadataFields/1.DocCount.html"><strong aria-hidden="true">1.6.8.0.</strong> DocCount.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/5.MetadataFields/2.FiledNames.html"><strong aria-hidden="true">1.6.8.1.</strong> FiledNames.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/5.MetadataFields/3.Ignored.html"><strong aria-hidden="true">1.6.8.2.</strong> Ignored.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/5.MetadataFields/4.Id.html"><strong aria-hidden="true">1.6.8.3.</strong> Id.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/5.MetadataFields/5.Index.html"><strong aria-hidden="true">1.6.8.4.</strong> Index.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/5.MetadataFields/6.Meta.html"><strong aria-hidden="true">1.6.8.5.</strong> Meta.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/5.MetadataFields/7.Routing.html"><strong aria-hidden="true">1.6.8.6.</strong> Routing.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/5.MetadataFields/8.Source.html"><strong aria-hidden="true">1.6.8.7.</strong> Source.md</a></li><li class="chapter-item "><a href="../../elasticSearch/3.Mapping/5.MetadataFields/9.Tier.html"><strong aria-hidden="true">1.6.8.8.</strong> Tier.md</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/queryDSL/README.html"><strong aria-hidden="true">1.7.</strong> queryDSL</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/queryDSL/1.QueryAndFilterContext.html"><strong aria-hidden="true">1.7.0.</strong> QueryAndFilterContext.md</a></li><li class="chapter-item "><a href="../../elasticSearch/queryDSL/Match中参数解析.html"><strong aria-hidden="true">1.7.1.</strong> Match中参数解析.md</a></li><li class="chapter-item "><a href="../../elasticSearch/queryDSL/FullTextQueries/README.html"><strong aria-hidden="true">1.7.2.</strong> FullTextQueries</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/queryDSL/FullTextQueries/1.IntervalsQuery.html"><strong aria-hidden="true">1.7.2.0.</strong> IntervalsQuery.md</a></li><li class="chapter-item "><a href="../../elasticSearch/queryDSL/FullTextQueries/2.MatchQuery.html"><strong aria-hidden="true">1.7.2.1.</strong> MatchQuery.md</a></li><li class="chapter-item "><a href="../../elasticSearch/queryDSL/FullTextQueries/3.MultiMatch.html"><strong aria-hidden="true">1.7.2.2.</strong> MultiMatch.md</a></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/queryDSL/CompoundQueries/README.html"><strong aria-hidden="true">1.7.3.</strong> CompoundQueries</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/queryDSL/CompoundQueries/1.BooleanQuery.html"><strong aria-hidden="true">1.7.3.0.</strong> BooleanQuery.md</a></li><li class="chapter-item "><a href="../../elasticSearch/queryDSL/CompoundQueries/2.FunctionScore.html"><strong aria-hidden="true">1.7.3.1.</strong> FunctionScore.md</a></li><li class="chapter-item "><a href="../../elasticSearch/queryDSL/CompoundQueries/3.BoostQuery.html"><strong aria-hidden="true">1.7.3.2.</strong> BoostQuery.md</a></li><li class="chapter-item "><a href="../../elasticSearch/queryDSL/CompoundQueries/4.ConstantScoreQuery.html"><strong aria-hidden="true">1.7.3.3.</strong> ConstantScoreQuery.md</a></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/queryDSL/SearchAfter.html"><strong aria-hidden="true">1.7.4.</strong> SearchAfter.md</a></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/7.ILM/README.html"><strong aria-hidden="true">1.8.</strong> ILM</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/7.ILM/FrozenIndices.html"><strong aria-hidden="true">1.8.0.</strong> FrozenIndices.md</a></li><li class="chapter-item "><a href="../../elasticSearch/7.ILM/ILM.html"><strong aria-hidden="true">1.8.1.</strong> ILM.md</a></li><li class="chapter-item "><a href="../../elasticSearch/7.ILM/2.Concepts/README.html"><strong aria-hidden="true">1.8.2.</strong> Concepts</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/7.ILM/2.Concepts/1.IndexLifecycle.html"><strong aria-hidden="true">1.8.2.0.</strong> IndexLifecycle.md</a></li><li class="chapter-item "><a href="../../elasticSearch/7.ILM/2.Concepts/2.Rollover.html"><strong aria-hidden="true">1.8.2.1.</strong> Rollover.md</a></li><li class="chapter-item "><a href="../../elasticSearch/7.ILM/2.Concepts/3.LifeCyclePolicyUpdates.html"><strong aria-hidden="true">1.8.2.2.</strong> LifeCyclePolicyUpdates.md</a></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/7.ILM/1.Overview/README.html"><strong aria-hidden="true">1.8.3.</strong> Overview</a></li><li class="chapter-item "><a href="../../elasticSearch/7.ILM/8.TroubleshootingIndexLifecycleManagementErrors/README.html"><strong aria-hidden="true">1.8.4.</strong> TroubleshootingIndexLifecycleManagementErrors</a></li><li class="chapter-item "><a href="../../elasticSearch/7.ILM/4.CustomizeBuiltInILMPolicy/README.html"><strong aria-hidden="true">1.8.5.</strong> CustomizeBuiltInILMPolicy</a></li><li class="chapter-item "><a href="../../elasticSearch/7.ILM/11.SkipRollover/README.html"><strong aria-hidden="true">1.8.6.</strong> SkipRollover</a></li><li class="chapter-item "><a href="../../elasticSearch/7.ILM/6.ConfigureALifecyclePolicy/README.html"><strong aria-hidden="true">1.8.7.</strong> ConfigureALifecyclePolicy</a></li><li class="chapter-item "><a href="../../elasticSearch/7.ILM/5.IndexLifecycleActions/README.html"><strong aria-hidden="true">1.8.8.</strong> IndexLifecycleActions</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/7.ILM/5.IndexLifecycleActions/1.Allocate.html"><strong aria-hidden="true">1.8.8.0.</strong> Allocate.md</a></li><li class="chapter-item "><a href="../../elasticSearch/7.ILM/5.IndexLifecycleActions/10.Shrink.html"><strong aria-hidden="true">1.8.8.1.</strong> Shrink.md</a></li><li class="chapter-item "><a href="../../elasticSearch/7.ILM/5.IndexLifecycleActions/11.Unfollow.html"><strong aria-hidden="true">1.8.8.2.</strong> Unfollow.md</a></li><li class="chapter-item "><a href="../../elasticSearch/7.ILM/5.IndexLifecycleActions/12.WaitForSnapshot.html"><strong aria-hidden="true">1.8.8.3.</strong> WaitForSnapshot.md</a></li><li class="chapter-item "><a href="../../elasticSearch/7.ILM/5.IndexLifecycleActions/2.Delete.html"><strong aria-hidden="true">1.8.8.4.</strong> Delete.md</a></li><li class="chapter-item "><a href="../../elasticSearch/7.ILM/5.IndexLifecycleActions/3.ForceMerge.html"><strong aria-hidden="true">1.8.8.5.</strong> ForceMerge.md</a></li><li class="chapter-item "><a href="../../elasticSearch/7.ILM/5.IndexLifecycleActions/4.Freeze.html"><strong aria-hidden="true">1.8.8.6.</strong> Freeze.md</a></li><li class="chapter-item "><a href="../../elasticSearch/7.ILM/5.IndexLifecycleActions/5.Migrate.html"><strong aria-hidden="true">1.8.8.7.</strong> Migrate.md</a></li><li class="chapter-item "><a href="../../elasticSearch/7.ILM/5.IndexLifecycleActions/6.ReadOnly.html"><strong aria-hidden="true">1.8.8.8.</strong> ReadOnly.md</a></li><li class="chapter-item "><a href="../../elasticSearch/7.ILM/5.IndexLifecycleActions/7.Rollover.html"><strong aria-hidden="true">1.8.8.9.</strong> Rollover.md</a></li><li class="chapter-item "><a href="../../elasticSearch/7.ILM/5.IndexLifecycleActions/8.SearchableSnapshot.html"><strong aria-hidden="true">1.8.8.10.</strong> SearchableSnapshot.md</a></li><li class="chapter-item "><a href="../../elasticSearch/7.ILM/5.IndexLifecycleActions/9.Setpriority.html"><strong aria-hidden="true">1.8.8.11.</strong> Setpriority.md</a></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/7.ILM/10.ManageExistingIndices/README.html"><strong aria-hidden="true">1.8.9.</strong> ManageExistingIndices</a></li><li class="chapter-item "><a href="../../elasticSearch/7.ILM/9.StartAndStopIndexLifecycleManagement/README.html"><strong aria-hidden="true">1.8.10.</strong> StartAndStopIndexLifecycleManagement</a></li><li class="chapter-item "><a href="../../elasticSearch/7.ILM/3.AutomateRolloverWithILM/README.html"><strong aria-hidden="true">1.8.11.</strong> AutomateRolloverWithILM</a></li><li class="chapter-item "><a href="../../elasticSearch/7.ILM/7.MigrateIndexAllocationFiltersToNodeRoles/README.html"><strong aria-hidden="true">1.8.12.</strong> MigrateIndexAllocationFiltersToNodeRoles</a></li><li class="chapter-item "><a href="../../elasticSearch/7.ILM/RolloverAPI.html"><strong aria-hidden="true">1.8.13.</strong> RolloverAPI.md</a></li><li class="chapter-item "><a href="../../elasticSearch/7.ILM/ShrinkIndexAPI.html"><strong aria-hidden="true">1.8.14.</strong> ShrinkIndexAPI.md</a></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/Datamanagement/README.html"><strong aria-hidden="true">1.9.</strong> Datamanagement</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/Datamanagement/DataTier.html"><strong aria-hidden="true">1.9.0.</strong> DataTier.md</a></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/snapshotAndRestore/README.html"><strong aria-hidden="true">1.10.</strong> snapshotAndRestore</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/snapshotAndRestore/CleanUpSnapshotRepo.html"><strong aria-hidden="true">1.10.0.</strong> CleanUpSnapshotRepo.md</a></li><li class="chapter-item "><a href="../../elasticSearch/snapshotAndRestore/CloneSnapshot.html"><strong aria-hidden="true">1.10.1.</strong> CloneSnapshot.md</a></li><li class="chapter-item "><a href="../../elasticSearch/snapshotAndRestore/CreateOrUpdateSnapshotAPI.html"><strong aria-hidden="true">1.10.2.</strong> CreateOrUpdateSnapshotAPI.md</a></li><li class="chapter-item "><a href="../../elasticSearch/snapshotAndRestore/CreateSnapshot.html"><strong aria-hidden="true">1.10.3.</strong> CreateSnapshot.md</a></li><li class="chapter-item "><a href="../../elasticSearch/snapshotAndRestore/DeleteSnapShot.html"><strong aria-hidden="true">1.10.4.</strong> DeleteSnapShot.md</a></li><li class="chapter-item "><a href="../../elasticSearch/snapshotAndRestore/DeleteSnapshotRepository.html"><strong aria-hidden="true">1.10.5.</strong> DeleteSnapshotRepository.md</a></li><li class="chapter-item "><a href="../../elasticSearch/snapshotAndRestore/GetSnapshotAPI.html"><strong aria-hidden="true">1.10.6.</strong> GetSnapshotAPI.md</a></li><li class="chapter-item "><a href="../../elasticSearch/snapshotAndRestore/RegisterASnapshot.html"><strong aria-hidden="true">1.10.7.</strong> RegisterASnapshot.md</a></li><li class="chapter-item "><a href="../../elasticSearch/snapshotAndRestore/RestoreSnapshot.html"><strong aria-hidden="true">1.10.8.</strong> RestoreSnapshot.md</a></li><li class="chapter-item "><a href="../../elasticSearch/snapshotAndRestore/SLM.html"><strong aria-hidden="true">1.10.9.</strong> SLM.md</a></li><li class="chapter-item "><a href="../../elasticSearch/snapshotAndRestore/SearchableSnapshots.html"><strong aria-hidden="true">1.10.10.</strong> SearchableSnapshots.md</a></li><li class="chapter-item "><a href="../../elasticSearch/snapshotAndRestore/SearchableSnapshotsMountAPI.html"><strong aria-hidden="true">1.10.11.</strong> SearchableSnapshotsMountAPI.md</a></li><li class="chapter-item "><a href="../../elasticSearch/snapshotAndRestore/repository-s3.html"><strong aria-hidden="true">1.10.12.</strong> repository-s3.md</a></li><li class="chapter-item "><a href="../../elasticSearch/snapshotAndRestore/使用OSS备份恢复集群实战.html"><strong aria-hidden="true">1.10.13.</strong> 使用OSS备份恢复集群实战.md</a></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/4.IndexTemplates/README.html"><strong aria-hidden="true">1.11.</strong> IndexTemplates</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/4.IndexTemplates/SimulateMultiComponentTemplates.html"><strong aria-hidden="true">1.11.0.</strong> SimulateMultiComponentTemplates.md</a></li><li class="chapter-item "><a href="../../elasticSearch/4.IndexTemplates/Templates.mm.html"><strong aria-hidden="true">1.11.1.</strong> Templates.mm.md</a></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/索引分片分配/README.html"><strong aria-hidden="true">1.12.</strong> 索引分片分配</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/索引分片分配/1.索引级别的分片分配控制.html"><strong aria-hidden="true">1.12.0.</strong> 索引级别的分片分配控制.md</a></li><li class="chapter-item "><a href="../../elasticSearch/索引分片分配/2.节点离开延迟分配.html"><strong aria-hidden="true">1.12.1.</strong> 节点离开延迟分配.md</a></li><li class="chapter-item "><a href="../../elasticSearch/索引分片分配/3.索引恢复优先级.html"><strong aria-hidden="true">1.12.2.</strong> 索引恢复优先级.md</a></li><li class="chapter-item "><a href="../../elasticSearch/索引分片分配/4.每个节点的总分片.html"><strong aria-hidden="true">1.12.3.</strong> 每个节点的总分片.md</a></li><li class="chapter-item "><a href="../../elasticSearch/索引分片分配/5.索引级别数据层分配过滤.html"><strong aria-hidden="true">1.12.4.</strong> 索引级别数据层分配过滤.md</a></li><li class="chapter-item "><a href="../../elasticSearch/索引分片分配/6.手动分配分片clusterRerouteAPI.html"><strong aria-hidden="true">1.12.5.</strong> 手动分配分片clusterRerouteAPI.md</a></li><li class="chapter-item "><a href="../../elasticSearch/索引分片分配/7.cluster-allocation-explain.html"><strong aria-hidden="true">1.12.6.</strong> cluster-allocation-explain.md</a></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/考纲解读/README.html"><strong aria-hidden="true">1.13.</strong> 考纲解读</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/考纲解读/1.ClusterManagement.html"><strong aria-hidden="true">1.13.0.</strong> ClusterManagement.md</a></li><li class="chapter-item "><a href="../../elasticSearch/考纲解读/2.DataManagement.html"><strong aria-hidden="true">1.13.1.</strong> DataManagement.md</a></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/README.html"><strong aria-hidden="true">1.14.</strong> TextAnalysis</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/3.Built-inAnalyzerReference/README.html"><strong aria-hidden="true">1.14.0.</strong> Built-inAnalyzerReference</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/3.Built-inAnalyzerReference/1.StandardAnalyzer.html"><strong aria-hidden="true">1.14.0.0.</strong> StandardAnalyzer.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/3.Built-inAnalyzerReference/10.OpenRefine指纹算法.html"><strong aria-hidden="true">1.14.0.1.</strong> OpenRefine指纹算法.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/3.Built-inAnalyzerReference/2.FingerprintAnalyzer.html"><strong aria-hidden="true">1.14.0.2.</strong> FingerprintAnalyzer.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/3.Built-inAnalyzerReference/3.KeywordAnalyzer.html"><strong aria-hidden="true">1.14.0.3.</strong> KeywordAnalyzer.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/3.Built-inAnalyzerReference/4.LanguageAnalyzers.html"><strong aria-hidden="true">1.14.0.4.</strong> LanguageAnalyzers.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/3.Built-inAnalyzerReference/5.PatternAnalyzer.html"><strong aria-hidden="true">1.14.0.5.</strong> PatternAnalyzer.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/3.Built-inAnalyzerReference/6.SimpleAnalyzer.html"><strong aria-hidden="true">1.14.0.6.</strong> SimpleAnalyzer.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/3.Built-inAnalyzerReference/7.StopAnalyzer.html"><strong aria-hidden="true">1.14.0.7.</strong> StopAnalyzer.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/3.Built-inAnalyzerReference/8.WhitespaceAnalyzer.html"><strong aria-hidden="true">1.14.0.8.</strong> WhitespaceAnalyzer.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/3.Built-inAnalyzerReference/9.Unicode文本分割算法.html"><strong aria-hidden="true">1.14.0.9.</strong> Unicode文本分割算法.md</a></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/5.TokenFilterReference/README.html"><strong aria-hidden="true">1.14.1.</strong> TokenFilterReference</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/5.TokenFilterReference/1.ASCIIFoldingTokenFilter.html"><strong aria-hidden="true">1.14.1.0.</strong> ASCIIFoldingTokenFilter.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/5.TokenFilterReference/10.EdgeN-gramTokenFilter.html"><strong aria-hidden="true">1.14.1.1.</strong> EdgeN-gramTokenFilter.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/5.TokenFilterReference/11.ElisionFokenFilter.html"><strong aria-hidden="true">1.14.1.2.</strong> ElisionFokenFilter.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/5.TokenFilterReference/12.FingerprintFokenFilter.html"><strong aria-hidden="true">1.14.1.3.</strong> FingerprintFokenFilter.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/5.TokenFilterReference/13.FlattenGraphTokenFilter.html"><strong aria-hidden="true">1.14.1.4.</strong> FlattenGraphTokenFilter.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/5.TokenFilterReference/2.CJKBigramTokenFilter.html"><strong aria-hidden="true">1.14.1.5.</strong> CJKBigramTokenFilter.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/5.TokenFilterReference/20.TokenFilter.html"><strong aria-hidden="true">1.14.1.6.</strong> TokenFilter.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/5.TokenFilterReference/3.CJKWidthTokenFilter.html"><strong aria-hidden="true">1.14.1.7.</strong> CJKWidthTokenFilter.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/5.TokenFilterReference/4.ClassicTokenFilter.html"><strong aria-hidden="true">1.14.1.8.</strong> ClassicTokenFilter.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/5.TokenFilterReference/5.CommonGramsTokenFilter.html"><strong aria-hidden="true">1.14.1.9.</strong> CommonGramsTokenFilter.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/5.TokenFilterReference/6.ConditionalTokenFilter.html"><strong aria-hidden="true">1.14.1.10.</strong> ConditionalTokenFilter.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/5.TokenFilterReference/7.DecimalDigitTokenFilter.html"><strong aria-hidden="true">1.14.1.11.</strong> DecimalDigitTokenFilter.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/5.TokenFilterReference/8.DelimitedPayloadTokenFilter.html"><strong aria-hidden="true">1.14.1.12.</strong> DelimitedPayloadTokenFilter.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/5.TokenFilterReference/9.DictionaryDecompounderFokenFilter.html"><strong aria-hidden="true">1.14.1.13.</strong> DictionaryDecompounderFokenFilter.md</a></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/6.CharacterFiltersReference/README.html"><strong aria-hidden="true">1.14.2.</strong> CharacterFiltersReference</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/6.CharacterFiltersReference/1.HTMLStripCharacterFilter.html"><strong aria-hidden="true">1.14.2.0.</strong> HTMLStripCharacterFilter.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/6.CharacterFiltersReference/2.MappingCharacterFilter.html"><strong aria-hidden="true">1.14.2.1.</strong> MappingCharacterFilter.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/6.CharacterFiltersReference/3.PatternReplaceCharacterFilter.html"><strong aria-hidden="true">1.14.2.2.</strong> PatternReplaceCharacterFilter.md</a></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/1.Concepts/README.html"><strong aria-hidden="true">1.14.3.</strong> Concepts</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/1.Concepts/1.AnatomyOfAnAnalyzer.html"><strong aria-hidden="true">1.14.3.0.</strong> AnatomyOfAnAnalyzer.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/1.Concepts/2.IndexAndSearchAnalysis.html"><strong aria-hidden="true">1.14.3.1.</strong> IndexAndSearchAnalysis.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/1.Concepts/3.Stemming.html"><strong aria-hidden="true">1.14.3.2.</strong> Stemming.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/1.Concepts/4.TokenGraphs.html"><strong aria-hidden="true">1.14.3.3.</strong> TokenGraphs.md</a></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/4.TokenizerReference/README.html"><strong aria-hidden="true">1.14.4.</strong> TokenizerReference</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/4.TokenizerReference/1.Ng-gram.html"><strong aria-hidden="true">1.14.4.0.</strong> Ng-gram.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/4.TokenizerReference/10.PathHierarchyTokenizer.html"><strong aria-hidden="true">1.14.4.1.</strong> PathHierarchyTokenizer.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/4.TokenizerReference/11.UAXURLEmailTokenizer.html"><strong aria-hidden="true">1.14.4.2.</strong> UAXURLEmailTokenizer.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/4.TokenizerReference/12.WhitespaceTokenizer.html"><strong aria-hidden="true">1.14.4.3.</strong> WhitespaceTokenizer.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/4.TokenizerReference/13.PatternTokenizer.html"><strong aria-hidden="true">1.14.4.4.</strong> PatternTokenizer.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/4.TokenizerReference/14.EdgeN-gramTokenizer.html"><strong aria-hidden="true">1.14.4.5.</strong> EdgeN-gramTokenizer.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/4.TokenizerReference/2.Keyword.html"><strong aria-hidden="true">1.14.4.6.</strong> Keyword.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/4.TokenizerReference/3.SimplePattern.html"><strong aria-hidden="true">1.14.4.7.</strong> SimplePattern.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/4.TokenizerReference/4.SimplePatternSplitTokenizer.html"><strong aria-hidden="true">1.14.4.8.</strong> SimplePatternSplitTokenizer.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/4.TokenizerReference/5.StandardTokenizer.html"><strong aria-hidden="true">1.14.4.9.</strong> StandardTokenizer.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/4.TokenizerReference/6.CharacterGroupTokenizer.html"><strong aria-hidden="true">1.14.4.10.</strong> CharacterGroupTokenizer.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/4.TokenizerReference/7.ClassicTokenizer.html"><strong aria-hidden="true">1.14.4.11.</strong> ClassicTokenizer.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/4.TokenizerReference/8.LetterTokenizer.html"><strong aria-hidden="true">1.14.4.12.</strong> LetterTokenizer.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/4.TokenizerReference/9.LowercaseTokenizer.html"><strong aria-hidden="true">1.14.4.13.</strong> LowercaseTokenizer.md</a></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/7.Normalizers/README.html"><strong aria-hidden="true">1.14.5.</strong> Normalizers</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/2.ConfigureTextAnalysis/README.html"><strong aria-hidden="true">1.14.6.</strong> ConfigureTextAnalysis</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/2.ConfigureTextAnalysis/0.AnalyzeAPI.html"><strong aria-hidden="true">1.14.6.0.</strong> AnalyzeAPI.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/2.ConfigureTextAnalysis/1.TestAnAnalyzer.html"><strong aria-hidden="true">1.14.6.1.</strong> TestAnAnalyzer.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/2.ConfigureTextAnalysis/2.ConfiguringBuilt-inAnalyzers.html"><strong aria-hidden="true">1.14.6.2.</strong> ConfiguringBuilt-inAnalyzers.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/2.ConfigureTextAnalysis/3.CreateACustomAnalyzer.html"><strong aria-hidden="true">1.14.6.3.</strong> CreateACustomAnalyzer.md</a></li><li class="chapter-item "><a href="../../elasticSearch/2.TextAnalysis/2.ConfigureTextAnalysis/4.SpecifyAnAnalyzer.html"><strong aria-hidden="true">1.14.6.4.</strong> SpecifyAnAnalyzer.md</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/1.IndexModules/README.html"><strong aria-hidden="true">1.15.</strong> IndexModules</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/1.IndexModules/1.Analysis.html"><strong aria-hidden="true">1.15.0.</strong> Analysis.md</a></li><li class="chapter-item "><a href="../../elasticSearch/1.IndexModules/10.HistoryRetention.html"><strong aria-hidden="true">1.15.1.</strong> HistoryRetention.md</a></li><li class="chapter-item "><a href="../../elasticSearch/1.IndexModules/11.IndexSorting.html"><strong aria-hidden="true">1.15.2.</strong> IndexSorting.md</a></li><li class="chapter-item "><a href="../../elasticSearch/1.IndexModules/12.IndexPressure.html"><strong aria-hidden="true">1.15.3.</strong> IndexPressure.md</a></li><li class="chapter-item "><a href="../../elasticSearch/1.IndexModules/2.IndexShardAllocation.html"><strong aria-hidden="true">1.15.4.</strong> IndexShardAllocation.md</a></li><li class="chapter-item "><a href="../../elasticSearch/1.IndexModules/3.Indexblocks.html"><strong aria-hidden="true">1.15.5.</strong> Indexblocks.md</a></li><li class="chapter-item "><a href="../../elasticSearch/1.IndexModules/4.Mapper.html"><strong aria-hidden="true">1.15.6.</strong> Mapper.md</a></li><li class="chapter-item "><a href="../../elasticSearch/1.IndexModules/5.Merge.html"><strong aria-hidden="true">1.15.7.</strong> Merge.md</a></li><li class="chapter-item "><a href="../../elasticSearch/1.IndexModules/6.SimilarityModule.html"><strong aria-hidden="true">1.15.8.</strong> SimilarityModule.md</a></li><li class="chapter-item "><a href="../../elasticSearch/1.IndexModules/7.Slowlog.html"><strong aria-hidden="true">1.15.9.</strong> Slowlog.md</a></li><li class="chapter-item "><a href="../../elasticSearch/1.IndexModules/8.Store.html"><strong aria-hidden="true">1.15.10.</strong> Store.md</a></li><li class="chapter-item "><a href="../../elasticSearch/1.IndexModules/9.Translog.html"><strong aria-hidden="true">1.15.11.</strong> Translog.md</a></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/8.SearchYourData/README.html"><strong aria-hidden="true">1.16.</strong> SearchYourData</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/8.SearchYourData/1.CollapseSearchResults.html"><strong aria-hidden="true">1.16.0.</strong> CollapseSearchResults.md</a></li><li class="chapter-item "><a href="../../elasticSearch/8.SearchYourData/2.FilterSearchResults.html"><strong aria-hidden="true">1.16.1.</strong> FilterSearchResults.md</a></li><li class="chapter-item "><a href="../../elasticSearch/8.SearchYourData/3.Highlight.html"><strong aria-hidden="true">1.16.2.</strong> Highlight.md</a></li><li class="chapter-item "><a href="../../elasticSearch/8.SearchYourData/4.LongRunningSearches.html"><strong aria-hidden="true">1.16.3.</strong> LongRunningSearches.md</a></li><li class="chapter-item "><a href="../../elasticSearch/8.SearchYourData/5.NearReaTimeSearch.html"><strong aria-hidden="true">1.16.4.</strong> NearReaTimeSearch.md</a></li><li class="chapter-item "><a href="../../elasticSearch/8.SearchYourData/6.PaginateSearchResults.html"><strong aria-hidden="true">1.16.5.</strong> PaginateSearchResults.md</a></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/5.Aliases/README.html"><strong aria-hidden="true">1.17.</strong> Aliases</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/5.Aliases/Aliases.mm.html"><strong aria-hidden="true">1.17.0.</strong> Aliases.mm.md</a></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/配置/README.html"><strong aria-hidden="true">1.18.</strong> 配置</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/配置/1.重要配置.html"><strong aria-hidden="true">1.18.0.</strong> 重要配置.md</a></li><li class="chapter-item "><a href="../../elasticSearch/配置/2.elasticsearch.yml核心配置.html"><strong aria-hidden="true">1.18.1.</strong> elasticsearch.yml核心配置.md</a></li><li class="chapter-item "><a href="../../elasticSearch/配置/3.es系统参数修改.html"><strong aria-hidden="true">1.18.2.</strong> es系统参数修改.md</a></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/dataStream.html"><strong aria-hidden="true">1.19.</strong> dataStream.md</a></li><li class="chapter-item "><a href="../../elasticSearch/elasticsearch-docker.html"><strong aria-hidden="true">1.20.</strong> elasticsearch-docker.md</a></li><li class="chapter-item "><a href="../../elasticSearch/es堆内存如何分配.html"><strong aria-hidden="true">1.21.</strong> es堆内存如何分配.md</a></li><li class="chapter-item "><a href="../../elasticSearch/scroll查询.html"><strong aria-hidden="true">1.22.</strong> scroll查询.md</a></li><li class="chapter-item "><a href="../../elasticSearch/乐观并发控制.html"><strong aria-hidden="true">1.23.</strong> 乐观并发控制.md</a></li><li class="chapter-item "><a href="../../elasticSearch/分布式检索.html"><strong aria-hidden="true">1.24.</strong> 分布式检索.md</a></li><li class="chapter-item "><a href="../../elasticSearch/分片内部原理.html"><strong aria-hidden="true">1.25.</strong> 分片内部原理.md</a></li><li class="chapter-item "><a href="../../elasticSearch/分词.html"><strong aria-hidden="true">1.26.</strong> 分词.md</a></li><li class="chapter-item "><a href="../../elasticSearch/慢日志.html"><strong aria-hidden="true">1.27.</strong> 慢日志.md</a></li><li class="chapter-item "><a href="../../elasticSearch/搜索引擎中的概念杂项.html"><strong aria-hidden="true">1.28.</strong> 搜索引擎中的概念杂项.md</a></li><li class="chapter-item "><a href="../../elasticSearch/数据分片.html"><strong aria-hidden="true">1.29.</strong> 数据分片.md</a></li><li class="chapter-item "><a href="../../elasticSearch/映射.html"><strong aria-hidden="true">1.30.</strong> 映射.md</a></li><li class="chapter-item "><a href="../../elasticSearch/杂项学习.html"><strong aria-hidden="true">1.31.</strong> 杂项学习.md</a></li><li class="chapter-item "><a href="../../elasticSearch/深入搜索.html"><strong aria-hidden="true">1.32.</strong> 深入搜索</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/深入搜索/全文搜索.html"><strong aria-hidden="true">1.32.0.</strong> 全文搜索.md</a></li><li class="chapter-item "><a href="../../elasticSearch/深入搜索/多字段搜索.html"><strong aria-hidden="true">1.32.1.</strong> 多字段搜索.md</a></li><li class="chapter-item "><a href="../../elasticSearch/深入搜索/结构化搜索.html"><strong aria-hidden="true">1.32.2.</strong> 结构化搜索.md</a></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/索引和分片.html"><strong aria-hidden="true">1.33.</strong> 索引和分片.md</a></li><li class="chapter-item "><a href="../../elasticSearch/索引管理.html"><strong aria-hidden="true">1.34.</strong> 索引管理.md</a></li><li class="chapter-item "><a href="../../elasticSearch/聚合.html"><strong aria-hidden="true">1.35.</strong> 聚合</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/聚合/RareTermsAggregation.html"><strong aria-hidden="true">1.35.0.</strong> RareTermsAggregation.md</a></li><li class="chapter-item "><a href="../../elasticSearch/聚合/Term.html"><strong aria-hidden="true">1.35.1.</strong> Term.md</a></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/评分标准与相关性.html"><strong aria-hidden="true">1.36.</strong> 评分标准与相关性.md</a></li><li class="chapter-item "><a href="../../elasticSearch/集群.html"><strong aria-hidden="true">1.37.</strong> 集群</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/集群/Health.html"><strong aria-hidden="true">1.37.0.</strong> Health.md</a></li></ol></li><li class="chapter-item "><a href="../../elasticSearch/集群内原理.html"><strong aria-hidden="true">1.38.</strong> 集群内原理.md</a></li><li class="chapter-item "><a href="../../elasticSearch/高可用专题.html"><strong aria-hidden="true">1.39.</strong> 高可用专题</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../elasticSearch/高可用专题/弹性设计.html"><strong aria-hidden="true">1.39.0.</strong> 弹性设计.md</a></li><li class="chapter-item "><a href="../../elasticSearch/高可用专题/跨集群复制.html"><strong aria-hidden="true">1.39.1.</strong> 跨集群复制.md</a></li><li class="chapter-item "><a href="../../elasticSearch/高可用专题/集群备份.html"><strong aria-hidden="true">1.39.2.</strong> 集群备份.md</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../mysql.html"><strong aria-hidden="true">2.</strong> mysql</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../mysql/mysql日志/README.html"><strong aria-hidden="true">2.0.</strong> mysql日志</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../mysql/mysql日志/mysql日志及分类.html"><strong aria-hidden="true">2.0.0.</strong> mysql日志及分类.md</a></li><li class="chapter-item "><a href="../../mysql/mysql日志/二进制日志.html"><strong aria-hidden="true">2.0.1.</strong> 二进制日志.md</a></li><li class="chapter-item "><a href="../../mysql/mysql日志/慢sql日志.html"><strong aria-hidden="true">2.0.2.</strong> 慢sql日志.md</a></li><li class="chapter-item "><a href="../../mysql/mysql日志/通用日志.html"><strong aria-hidden="true">2.0.3.</strong> 通用日志.md</a></li><li class="chapter-item "><a href="../../mysql/mysql日志/错误日志.html"><strong aria-hidden="true">2.0.4.</strong> 错误日志.md</a></li></ol></li><li class="chapter-item "><a href="../../mysql/mysqlDataFile.html"><strong aria-hidden="true">2.1.</strong> mysqlDataFile.md</a></li><li class="chapter-item "><a href="../../mysql/mysqlfunction.html"><strong aria-hidden="true">2.2.</strong> mysqlfunction.md</a></li><li class="chapter-item "><a href="../../mysql/mysqlpdump.html"><strong aria-hidden="true">2.3.</strong> mysqlpdump.md</a></li><li class="chapter-item "><a href="../../mysql/mysqlzip安装.html"><strong aria-hidden="true">2.4.</strong> mysqlzip安装.md</a></li><li class="chapter-item "><a href="../../mysql/mysql公用表达式.html"><strong aria-hidden="true">2.5.</strong> mysql公用表达式.md</a></li><li class="chapter-item "><a href="../../mysql/mysql学习.html"><strong aria-hidden="true">2.6.</strong> mysql学习.md</a></li><li class="chapter-item "><a href="../../mysql/mysql官方文档.html"><strong aria-hidden="true">2.7.</strong> mysql官方文档</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../mysql/mysql官方文档/mysql程序/README.html"><strong aria-hidden="true">2.7.0.</strong> mysql程序</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../mysql/mysql官方文档/mysql程序/使用mysql相关程序.html"><strong aria-hidden="true">2.7.0.0.</strong> 使用mysql相关程序.md</a></li></ol></li><li class="chapter-item "><a href="../../mysql/mysql官方文档/mysql程序.html"><strong aria-hidden="true">2.7.1.</strong> mysql程序.md</a></li><li class="chapter-item "><a href="../../mysql/mysql官方文档/客户端.html"><strong aria-hidden="true">2.7.2.</strong> 客户端.md</a></li></ol></li><li class="chapter-item "><a href="../../mysql/mysql执行计划.html"><strong aria-hidden="true">2.8.</strong> mysql执行计划.md</a></li><li class="chapter-item "><a href="../../mysql/空值处理函数.html"><strong aria-hidden="true">2.9.</strong> 空值处理函数.md</a></li></ol></li><li class="chapter-item "><a href="../../oracle.html"><strong aria-hidden="true">3.</strong> oracle</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../oracle/Oracle小知识点.html"><strong aria-hidden="true">3.0.</strong> Oracle小知识点.md</a></li><li class="chapter-item "><a href="../../oracle/oracledocker快速搭建.html"><strong aria-hidden="true">3.1.</strong> oracledocker快速搭建.md</a></li><li class="chapter-item "><a href="../../oracle/oracle多表更新方法.html"><strong aria-hidden="true">3.2.</strong> oracle多表更新方法.md</a></li></ol></li><li class="chapter-item "><a href="../../sql通用优化.html"><strong aria-hidden="true">4.</strong> sql通用优化.md</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                    </div>

                    <h1 class="menu-title">DB笔记</h1>

                    <div class="right-buttons">

                    </div>
                </div>


                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <link rel="stylesheet" href="/note-service/db/infisearch_assets/search-ui-light.css">
<style>.light .infi-root,
.rust .infi-root,
.coal .infi-root,
.navy .infi-root,
.ayu .infi-root {
    --infi-shadow: none;
    --infi-border: 3px solid var(--table-header-bg);
    --infi-bg: var(--bg);
    --infi-triangle-bg: var(--table-header-bg);
    --infi-item-box-shadow: 0 1px 5px rgba(196, 192, 187, 0.8);
    --infi-title-fg: var(--fg);
    --infi-title-hover-fg: var(--fg);
    --infi-title-hover-bg: var(--table-header-bg);
    --infi-title-border-bottom-hover: 2px solid var(--table-header-bg);
    --infi-heading-fg: var(--fg);
    --infi-heading-hover-fg: var(--fg);
    --infi-body-fg: var(--fg);
    --infi-body-hover-fg: var(--fg);
    --infi-sub-bg: var(--bg);
    --infi-highlight: var(--search-mark-bg);
    --infi-highlight-bg: none;
    --infi-header-fg: var(--fg);
    --infi-checkbox-bg: #f8f8f8;
    --infi-checkbox-checked-bg: #fff;
    --infi-checkbox-border: #414141;
    --infi-filter-header-active: var(--infi-title-bg);
    --infi-error-fg: var(--fg);
    --infi-fine-print-fg: var(--fg);
    --infi-loading-bg: var(--fg);
    --infi-loading-secondary-bg: var(--fg);
    --infi-load-more-fg: var(--infi-title-fg);
    --infi-load-more-bg: var(--infi-title-bg);
    --infi-load-more-hover-fg: var(--infi-title-hover-fg);
    --infi-load-more-hover-bg: var(--infi-title-hover-bg);
    --infi-scrollbar-bg: none;
    --infi-scrollbar-thumb-bg: var(--sidebar-non-existant);
    --infi-fs-button-input-fg: var(--searchbar-shadow-color);
    --infi-fs-border: 3px solid var(--sidebar-bg);
    --infi-fs-box-shadow: none;
    --infi-fs-header-bg: var(--sidebar-bg);
    --infi-fs-header-box-shadow: none;
    --infi-tip-table-header-border: var(--table-border-color);
    --infi-tip-table-border: transparent;
    --infi-tip-table-alternate: var(--table-alternate-bg);
    --infi-tip-bg: var(--sidebar-bg);
    --infi-tip-fg: var(--sidebar-fg);
    --infi-tip-code-fg: var(--inline-code-color);
    --infi-tip-code-bg: transparent;
    --infi-tip-icon-bg: rgb(230, 230, 230);
    --infi-tip-icon-fg: rgb(80, 80, 80);
}

.light .infi-root {
    --infi-fs-header-close-fg: var(--searchresults-header-fg);
    --infi-fs-header-close-hover-fg: var(--fg);
}

.ayu .infi-root,
.rust .infi-root,
.coal .infi-root,
.navy .infi-root {
    --infi-fs-header-close-fg: var(--sidebar-fg);
    --infi-fs-header-close-hover-fg: white;
}

.ayu .infi-root,
.rust .infi-root {
    --infi-tip-code-fg: var(--search-mark-bg) !important;
    --infi-tip-icon-bg: rgb(200, 200, 200);
    --infi-tip-icon-fg: rgb(50, 50, 50);
}

.light .infi-root .infi-list-item.focus,
.rust .infi-root .infi-list-item.focus,
.coal .infi-root .infi-list-item.focus,
.navy .infi-root .infi-list-item.focus,
.ayu .infi-root .infi-list-item.focus {
    outline: 2px solid grey;
}

.light .infi-root,
.coal .infi-root,
.navy .infi-root,
.ayu .infi-root {
    --infi-title-bg: var(--theme-hover);
    --infi-sub-hover-bg: var(--table-alternate-bg);
    --infi-title-border-bottom: 2px solid var(--theme-hover);
}

.light .infi-root {
    --infi-highlight: #82a6c4;
    --infi-sub-hover-bg: #ebebeb;
}

.rust .infi-root {
    --infi-highlight: #bc8e6a;

    --infi-tip-table-alternate: var(--sidebar-bg);
    --infi-title-bg: var(--table-header-bg);
    --infi-title-border-bottom: 2px solid var(--table-header-bg);

    --infi-sub-hover-bg: #c6bbb1;
    --infi-title-bg: #bbada1;
    --infi-title-border-bottom: 2px solid #bbada1;
    --infi-title-hover-fg: #000;
    --infi-title-hover-bg: #a19488;
    --infi-title-border-bottom-hover: 2px solid #a19488;
    --infi-body-hover-fg: #1e1e1e;
    --infi-heading-hover-fg: #1e1e1e;
}

.coal .infi-root {
    --infi-highlight: #496c8a;
    --infi-sub-hover-bg: #272a2b;
}

.infi-theme .infi-root .infi-tip-item code,
.rust .infi-root .infi-tip-item code {
    color: var(--infi-tip-code-fg) !important;;
}

.coal .infi-root,
.navy .infi-root,
.ayu .infi-root {
    --infi-item-box-shadow: 0 1px 5px rgb(50, 50, 50);
    --infi-fs-input-fg: var(--fg);
    --infi-fs-input-focus-border: 2px solid #4f95cc;
    --infi-fs-input-focus-box-shadow: 0 0 5px -1px #63baff;
    --infi-key-fg: #fff;
    --infi-key-bg: #7d7d7d;
    --infi-checkbox-bg: #313233;
    --infi-checkbox-checked-bg: #424243;
    --infi-checkbox-border: #525354;
}

.rust .infi-root {
    --infi-fs-input-fg: var(--sidebar-fg);
    --infi-fs-input-bg: #29201d;
    --infi-fs-input-border: 2px solid #584d4a;
    --infi-fs-input-focus-border: 2px solid #4f95cc;
    --infi-fs-input-focus-box-shadow: 0 0 5px -1px #63baff;
}

.coal .infi-root {
    --infi-fs-input-bg: #1d1f21;
    --infi-fs-input-border: 2px solid #3e4144;
}

.navy .infi-root {
    --infi-fs-input-bg: #1e222f;
    --infi-fs-input-border: 2px solid #3d4252;
    --infi-sub-hover-bg: #242734;
}

.ayu .infi-root {
    --infi-fs-input-fg: var(--fg);
    --infi-fs-input-bg: #2b3035;
    --infi-fs-input-border: 2px solid #43474c;
    --infi-fs-input-focus-border: 2px solid #4f95cc;
    --infi-fs-input-focus-box-shadow: 0 0 5px -1px #63baff;
    --infi-sub-hover-bg: #282e35;
}

#infi-search {
    width: 100%;
    border-radius: 3px;
    box-sizing: border-box;
    padding: 10px 16px;
    border: 1px solid var(--searchbar-border-color);
    background: var(--searchbar-bg);
    color: var(--searchbar-fg);
}

#infi-search:focus:not(.infi-button-input) {
    box-shadow: 0 0 3px var(--searchbar-shadow-color);
}

#infi-search.infi-button-input {
    width: 100px;
}

#infi-search.infi-button-input::placeholder {
    position: relative;
    left: 14px;
}

#infi-search.infi-button-input:hover {
    transition: 0.3s ease-out;
    background: var(--infi-fs-button-input-bg) !important;
    outline: 2px solid var(--infi-fs-button-input-bg);
}

#infi-search.infi-button-input:hover::placeholder {
    color: var(--infi-fs-button-input-fg) !important;
}

@media print {
    #infi-search {
        display: none;
    }
}

#infisearch-mdbook-target {
    position: relative;
}

/*
 * For this plugin, don't show the controls until there is a query.
 */
#infisearch-mdbook-target.infi-empty-input > * {
    display: none;
}

.infi-root:not(.infi-fs-root) {
    display: block;
}

.light .infi-root .infi-title::after,
.rust .infi-root .infi-title::after,
.coal .infi-root .infi-title::after,
.navy .infi-root .infi-title::after,
.ayu .infi-root .infi-title::after {
    content: none;
    display: none;
}

.infi-header {
    padding-bottom: 9px;
}

.infi-load-more {
    padding: 7px 15px;
}
</style>
<p><input
    type="search"
    id="infi-search"
    placeholder="Search this book ..."
/></p>
<p><span style="font-weight: 600;"><!--preload weight 600--></span></p>
<div id="infisearch-mdbook-target"></div>
<h1 id="es8x语义检索"><a class="header" href="#es8x语义检索">ES8.X语义检索</a></h1>
<h2 id="dense-vector-field-type"><a class="header" href="#dense-vector-field-type">Dense vector field type</a></h2>
<ol>
<li>
<p>dense_vector 字段类型存储稠密的数值向量。稠密向量字段主要用于k最近邻（kNN）搜索。</p>
</li>
<li>
<p>dense_vector类型不支持聚合或排序。</p>
</li>
<li>
<p>您可以将dense_vector字段添加为基于float类型的数值数组，默认情况下为element_type。</p>
</li>
</ol>
<pre><code class="language-console">PUT my-index
{
  "mappings": {
    "properties": {
      "my_vector": {
        "type": "dense_vector",
        "dims": 3
      },
      "my_text" : {
        "type" : "keyword"
      }
    }
  }
}

PUT my-index/_doc/1
{
  "my_text" : "text1",
  "my_vector" : [0.5, 10, 6]
}

PUT my-index/_doc/2
{
  "my_text" : "text2",
  "my_vector" : [-0.5, 10, 10]
}

</code></pre>
<p>与大多数其他数据类型不同，稠密向量始终是单值的。在一个稠密向量字段中不可能存储多个数值。</p>
<h3 id="index-vectors-for-knn-search"><a class="header" href="#index-vectors-for-knn-search">Index vectors for kNN search</a></h3>
<ol>
<li>
<p>k最近邻（kNN）搜索会找到与查询向量最相似的k个向量。</p>
</li>
<li>
<p>稠密向量字段可用于在<strong>script_score</strong>查询中对文档进行排名。这样你就可以通过扫描所有文档并根据相似度对它们进行排名来执行蛮力kNN(force kNN)搜索。</p>
</li>
<li>
<p>在许多情况下，蛮力kNN搜索效率不够高。因此，dense_vector类型支持将向量索引到专门的数据结构中，以通过搜索API中的<a href="https://www.elastic.co/guide/en/elasticsearch/reference/8.11/search-search.html#search-api-knn">knn选项</a>支持快速kNN检索。</p>
</li>
<li>
<p>浮点元素大小在128到4096之间的未映射数组字段会动态映射为带有默认余弦相似度的dense_vector。您可以通过将字段显式映射为具有所需相似度的dense_vector来覆盖默认相似度。</p>
</li>
</ol>
<p>稠密向量字段默认启用索引。启用索引后，您可以定义在kNN搜索中使用的向量相似度。</p>
<pre><code>PUT my-index-2
{
  "mappings": {
    "properties": {
      "my_vector": {
        "type": "dense_vector",
        "dims": 3,
        "similarity": "dot_product"
      }
    }
  }
}
</code></pre>
<p>为了进行近似k最近邻搜索的向量索引是一个昂贵的过程。对包含启用索引的向量字段的文档进行摄取可能需要相当长的时间。了解更多关于内存需求的内容，请参阅k最近邻（kNN）搜索。</p>
<p><strong>关闭索引向量</strong></p>
<pre><code>PUT my-index-2
{
  "mappings": {
    "properties": {
      "my_vector": {
        "type": "dense_vector",
        "dims": 3,
        "index": false
      }
    }
  }
}
</code></pre>
<p>Elasticsearch uses the <a href="https://arxiv.org/abs/1603.09320">HNSW algorithm</a> to support efficient kNN search. Like most kNN algorithms, HNSW is an approximate method that sacrifices result accuracy for improved speed.</p>
<h4 id="parameters-for-dense-vector-fields"><a class="header" href="#parameters-for-dense-vector-fields">Parameters for dense vector fields</a></h4>
<h5 id="element_type"><a class="header" href="#element_type"><strong>element_type</strong>：</a></h5>
<p>（可选，字符串）用于编码向量的数据类型。支持的数据类型为float（默认）和byte。float为每个维度索引一个4字节的浮点值。byte为每个维度索引一个1字节的整数值。使用byte可以显著减小索引大小，但牺牲了精度。使用byte的向量需要在-128到127之间具有整数值的维度，包括索引和搜索。</p>
<h5 id="dims"><a class="header" href="#dims"><strong>dims</strong>：</a></h5>
<p>（可选，整数）向量维度数。不能超过4096。如果未指定dims，它将被设置为添加到字段的第一个向量的长度。</p>
<h5 id="index"><a class="header" href="#index"><strong>index</strong>：</a></h5>
<p>是否索引</p>
<h5 id="similarity"><a class="header" href="#similarity"><strong>similarity</strong>：</a></h5>
<p>相似度计算方式</p>
<p>（可选*，字符串）在kNN搜索中使用的向量相似度度量。文档根据它们的向量字段与查询向量的相似度进行排名。每个文档的_score将根据相似度推导出来，以确保分数为正，并且较大的分数对应较高的排名。默认为余弦相似度。</p>
<p><strong>l2_norm</strong>：基于向量之间的L2距离（也称为欧氏距离）计算相似度。文档的_score计算公式为1 / (1 + l2_norm(query, vector)^2)。</p>
<p><strong>dot_product</strong>：计算两个单位向量的点积。此选项提供了执行余弦相似度的优化方法。约束和计算得分由element_type定义。</p>
<p>当element_type为float时，所有向量必须是单位长度，包括文档和查询向量。文档的_score计算公式为(1 + dot_product(query, vector)) / 2。</p>
<p>当element_type为byte时，所有向量必须具有相同的长度，包括文档和查询向量，否则结果将不准确。文档的_score计算公式为0.5 + (dot_product(query, vector) / (32768 * dims))，其中dims是每个向量的维数。</p>
<p><strong>cosine</strong>：计算余弦相似度。请注意，执行余弦相似度的最有效方法是将所有向量归一化为单位长度，然后使用点积。只有在需要保留原始向量并且无法提前归一化它们时，才应使用余弦相似度。文档的_score计算公式为(1 + cosine(query, vector)) / 2。余弦相似度不允许具有零大小的向量，因为在这种情况下余弦值未定义。</p>
<p><strong>max_inner_product</strong>：计算两个向量的最大内积。这类似于点积，但不要求向量归一化。这意味着每个向量的大小可以显著影响得分。文档的_score经过调整以防止出现负值。对于max_inner_product值小于0的情况，_score为1 / (1 + -1 * max_inner_product(query, vector))。对于非负max_inner_product的结果，_score计算为max_inner_product(query, vector) + 1。</p>
<p>注意：虽然它们在概念上相关，但相似度参数与文本字段相似度不同，并接受一组不同的选项。</p>
<h5 id="index_options"><a class="header" href="#index_options"><strong>index_options</strong></a></h5>
<p>配置kNN索引算法的可选部分。HNSW算法有两个内部参数，影响数据结构的构建方式。可以调整这些参数以提高结果的准确性，但会降低索引速度。提供index_options时，必须定义其所有属性。</p>
<p><strong>type</strong>：</p>
<p>**m：**knn算法的类型、只有 hnsw支持</p>
<h2 id="k-nearest-neighbor-knn-search"><a class="header" href="#k-nearest-neighbor-knn-search">k-nearest neighbor (kNN) search</a></h2>
<p>k-最近邻（kNN）搜索会找出与查询向量最接近的k个向量，通过相似度度量来衡量。</p>
<p>kNN的常见用途包括：</p>
<ol>
<li>基于自然语言处理（NLP）算法的相关性排名</li>
<li>产品推荐和推荐引擎</li>
<li>图像或视频的相似度搜索</li>
</ol>
<h3 id="prerequisites"><a class="header" href="#prerequisites">Prerequisites</a></h3>
<p>要运行kNN搜索，您必须能够将数据转换为有意义的向量值。您可以使用Elasticsearch中的自然语言处理（NLP）模型创建这些向量，或者在Elasticsearch之外生成它们。向量可以作为dense_vector字段值添加到文档中。查询被表示为具有相同维度的向量。</p>
<p>设计您的向量，使得文档向量根据相似度度量越接近查询向量，匹配度就越好。</p>
<h3 id="knn-methods"><a class="header" href="#knn-methods">kNN methods</a></h3>
<p>Elasticsearch支持两种kNN搜索方法：</p>
<ol>
<li>使用knn搜索选项的近似kNN</li>
<li>使用带有向量函数的script_score查询的精确的暴力kNN</li>
</ol>
<p>在大多数情况下，您会希望使用近似kNN。近似kNN提供更低的延迟，但索引速度较慢并且准确度不完美。</p>
<p>精确的暴力kNN保证准确的结果，但在处理大型数据集时扩展性不佳。采用这种方法，script_score查询必须扫描每个匹配的文档来计算向量函数，这可能导致搜索速度较慢。但是，您可以通过使用查询来限制传递给函数的匹配文档数量来改善延迟。如果将数据过滤到文档的一个小子集，您可以通过这种方法获得良好的搜索性能。</p>
<h3 id="approximate-knn"><a class="header" href="#approximate-knn">Approximate kNN</a></h3>
<p>临近KNN算法有资源要求、特别的是：所有向量数据必须 合适 节点的 page cache 以使之高效：请参考： <a href="https://www.elastic.co/guide/en/elasticsearch/reference/8.11/tune-knn-search.html">approximate kNN search tuning guide</a> 调优</p>
<p>要运行近似kNN搜索，请使用knn选项来搜索一个或多个启用了索引的dense_vector字段。</p>
<h4 id="使用knn搜索"><a class="header" href="#使用knn搜索">使用KNN搜索</a></h4>
<p>明确定义一个或多个dense_vector字段。近似kNN搜索需要以下映射选项：</p>
<pre><code class="language-console">PUT image-index
{
  "mappings": {
    "properties": {
      "image-vector": {
        "type": "dense_vector",
        "dims": 3,
        "index": true,
        "similarity": "l2_norm"
      },
      "title-vector": {
        "type": "dense_vector",
        "dims": 5,
        "index": true,
        "similarity": "l2_norm"
      },
      "title": {
        "type": "text"
      },
      "file-type": {
        "type": "keyword"
      }
    }
  }
}
</code></pre>
<pre><code>POST image-index/_bulk?refresh=true
{ "index": { "_id": "1" } }
{ "image-vector": [1, 5, -20], "title-vector": [12, 50, -10, 0, 1], "title": "moose family", "file-type": "jpg" }
{ "index": { "_id": "2" } }
{ "image-vector": [42, 8, -15], "title-vector": [25, 1, 4, -12, 2], "title": "alpine lake", "file-type": "png" }
{ "index": { "_id": "3" } }
{ "image-vector": [15, 11, 23], "title-vector": [1, 5, 25, 50, 20], "title": "full moon", "file-type": "jpg" }
...
</code></pre>
<p>Run the search using the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/8.11/search-search.html#search-api-knn"><code>knn</code> option</a>.</p>
<pre><code class="language-console">POST image-index/_search
{
  "knn": {
    "field": "image-vector",
    "query_vector": [-5, 9, -12],
    "k": 10,
    "num_candidates": 100
  },
  "fields": [ "title", "file-type" ]
}
</code></pre>
<p>注意：在8.0版本中添加了对近似kNN搜索的支持。在此之前，dense_vector字段不支持在映射中启用索引。如果在8.0版本之前创建了包含dense_vector字段的索引，那么为了支持近似kNN搜索，数据必须使用设置index: true的新字段映射进行重新索引。</p>
<h4 id="tune-approximate-knn-for-speed-or-accuracy"><a class="header" href="#tune-approximate-knn-for-speed-or-accuracy">Tune approximate kNN for speed or accuracy</a></h4>
<p><strong>KNN调优</strong></p>
<p>为了收集结果，kNN搜索API在每个分片上找到了num_candidates个近似最近邻候选。搜索计算这些候选向量与查询向量的相似性，从每个分片中选择k个最相似的结果。然后搜索合并每个分片的结果，返回全局前k个最近邻。</p>
<p>您可以增加num_candidates以获得更准确的结果，但搜索速度会变慢。num_candidates值较高的搜索考虑了每个分片中更多的候选。这需要更多时间，但搜索有更高的概率找到真正的前k个最近邻。</p>
<p>同样，您可以减少num_candidates以获得更快的搜索，但结果可能不太准确。</p>
<h4 id="approximate-knn-using-byte-vectors"><a class="header" href="#approximate-knn-using-byte-vectors">Approximate kNN using byte vectors</a></h4>
<p><strong>字节向量KNN搜索</strong></p>
<p>近似kNN搜索API支持字节值向量和浮点值向量。使用knn选项来搜索一个element_type设置为byte且启用索引的dense_vector字段。</p>
<p><strong>创建Mapping</strong></p>
<pre><code class="language-console">PUT byte-image-index
{
  "mappings": {
    "properties": {
      "byte-image-vector": {
        "type": "dense_vector",
        "element_type": "byte",
        "dims": 2,
        "index": true,
        "similarity": "cosine"
      },
      "title": {
        "type": "text"
      }
    }
  }
}
</code></pre>
<p><strong>索引数据</strong></p>
<pre><code class="language-console">POST byte-image-index/_bulk?refresh=true
{ "index": { "_id": "1" } }
{ "byte-image-vector": [5, -20], "title": "moose family" }
{ "index": { "_id": "2" } }
{ "byte-image-vector": [8, -15], "title": "alpine lake" }
{ "index": { "_id": "3" } }
{ "byte-image-vector": [11, 23], "title": "full moon" }
</code></pre>
<p><strong>向量检索</strong></p>
<pre><code class="language-console">POST byte-image-index/_search
{
  "knn": {
    "field": "byte-image-vector",
    "query_vector": [-5, 9],
    "k": 10,
    "num_candidates": 100
  },
  "fields": [ "title" ]
}
</code></pre>
<h4 id="filtered-knn-search"><a class="header" href="#filtered-knn-search">Filtered kNN search</a></h4>
<p>kNN搜索API支持使用过滤器限制搜索。搜索将返回与过滤器查询匹配的前k个文档。</p>
<p>以下请求执行了一个由文件类型字段进行筛选的近似kNN搜索：</p>
<pre><code class="language-console">POST image-index/_search
{
  "knn": {
    "field": "image-vector",
    "query_vector": [54, 10, -2],
    "k": 5,
    "num_candidates": 50,
    "filter": {
      "term": {
        "file-type": "png"
      }
    }
  },
  "fields": ["title"],
  "_source": false
}
</code></pre>
<p><strong>注意：</strong></p>
<p>在进行近似kNN搜索时应用过滤器，以确保返回k个匹配的文档。这与后过滤方法形成对比，后过滤是在近似kNN搜索完成后应用过滤器。后过滤的缺点是有时会返回少于k个结果，即使有足够的匹配文档。</p>
<h4 id="combine-approximate-knn-with-other-features"><a class="header" href="#combine-approximate-knn-with-other-features">Combine approximate kNN with other features</a></h4>
<p><strong>KNN混合检索</strong></p>
<pre><code class="language-console">POST image-index/_search
{
  "query": {
    "match": {
      "title": {
        "query": "mountain lake",
        "boost": 0.9
      }
    }
  },
  "knn": {
    "field": "image-vector",
    "query_vector": [54, 10, -2],
    "k": 5,
    "num_candidates": 50,
    "boost": 0.1
  },
  "size": 10
}
</code></pre>
<p>这个搜索找到全局前k=5个向量匹配，将它们与匹配查询的结果结合起来，最后返回前10个得分最高的结果。knn和查询匹配通过一个分离操作进行组合，就好像你对它们进行布尔或操作一样。前k个向量结果代表了所有索引分片中全局最近的邻居。</p>
<p>每个命中的得分是knn和查询得分的总和。您可以指定一个提升值来为总和中的每个得分赋予权重。在上面的例子中，得分将被计算为</p>
<pre><code>score = 0.9 * match_score + 0.1 * knn_score
</code></pre>
<p>knn选项也可以与聚合一起使用。一般来说，Elasticsearch会计算所有匹配搜索条件的文档的聚合。因此，对于近似kNN搜索，聚合是在前k个最近的文档上计算的。如果搜索还包括查询，那么聚合将在knn和查询匹配的组合集上进行计算。</p>
<h4 id="perform-semantic-search"><a class="header" href="#perform-semantic-search">Perform semantic search</a></h4>
<blockquote>
<p><strong>语义化检索</strong></p>
</blockquote>
<ol>
<li>
<p>kNN搜索使您能够使用先前部署的文本嵌入模型  <a href="https://www.elastic.co/guide/en/machine-learning/8.11/ml-nlp-search-compare.html#ml-nlp-text-embedding">text embedding model</a>. 执行语义搜索。与在搜索词上进行字面匹配不同，语义搜索是根据搜索查询的意图和上下文含义检索结果。</p>
</li>
<li>
<p>在内部，文本嵌入NLP模型会从您提供的输入查询字符串（称为model_text）生成一个密集向量。然后，它会与包含使用相同文本嵌入机器学习模型创建的密集向量的索引进行匹配。搜索结果是根据模型学习到的语义相似性。</p>
</li>
</ol>
<p><strong>注意</strong></p>
<p>要执行语义搜索：</p>
<ul>
<li>您需要一个包含输入数据的密集向量表示的索引进行搜索，</li>
<li>您必须使用与创建输入数据的密集向量相同的文本嵌入模型进行搜索，</li>
<li>文本嵌入NLP模型部署必须已经启动。</li>
</ul>
<p>在query_vector_builder对象中引用已部署的文本嵌入模型或模型部署，并将搜索查询作为model_text提供。</p>
<pre><code>{
  "knn": {
    "field": "dense-vector-field",
    "k": 10,
    "num_candidates": 100,
    "query_vector_builder": {
      "text_embedding": { 
        "model_id": "my-text-embedding-model", 
        "model_text": "The opposite of blue" 
      }
    }
  }
}
</code></pre>
<h4 id="search-multiple-knn-fields"><a class="header" href="#search-multiple-knn-fields">Search multiple kNN fields</a></h4>
<p><strong>多字段KNN检索</strong></p>
<pre><code class="language-console">POST image-index/_search
{
  "query": {
    "match": {
      "title": {
        "query": "mountain lake",
        "boost": 0.9
      }
    }
  },
  "knn": [ {
    "field": "image-vector",
    "query_vector": [54, 10, -2],
    "k": 5,
    "num_candidates": 50,
    "boost": 0.1
  },
  {
    "field": "title-vector",
    "query_vector": [1, 20, -52, 23, 10],
    "k": 10,
    "num_candidates": 10,
    "boost": 0.5
  }],
  "size": 10
}
</code></pre>
<p>该搜索找到图像向量的全局前k = 5个匹配项，以及标题向量的全局前k = 10个匹配项。然后将这些 TopValues 与匹配查询的匹配项组合，返回前10个文档。多个knn条目和查询匹配通过一个分离(disjunction)进行组合，就好像在它们之间进行了布尔或操作。前k个向量结果代表了所有索引分片中的全局最近邻居。</p>
<p>具有上述配置的文档的评分为：</p>
<p><code>score = 0.9 * match_score + 0.1 * knn_score_image-vector + 0.5 * knn_score_title-vector</code></p>
<h4 id="search-knn-with-expected-similarity"><a class="header" href="#search-knn-with-expected-similarity">Search kNN with expected similarity</a></h4>
<blockquote>
<p>避免经过filter过滤后，没有相似度匹配的文档。而导致  返回的K个文档相似度不高</p>
</blockquote>
<p>尽管kNN是一个强大的工具，它总是试图返回k个最近的邻居。因此，当使用带有过滤器的knn时，您可能会过滤掉所有相关文档，只剩下一些无关的文档进行搜索。在这种情况下，knn仍会尽力返回k个最近的邻居，即使这些邻居在向量空间中可能相距甚远。</p>
<p>为了缓解这种担忧，在knn子句中提供了一个相似度参数。该值是被视为匹配的向量所需的最小相似度。具有此参数的knn搜索流程如下：</p>
<ol>
<li>
<p>应用任何用户提供的过滤查询</p>
</li>
<li>
<p>探索向量空间以获取k个向量</p>
</li>
<li>
<p>不返回超出配置相似度的任何向量</p>
</li>
</ol>
<p>这里有一个例子。在这个例子中，我们搜索给定的query_vector的k个最近邻居。但是，在应用过滤器并要求找到的向量之间至少具有提供的相似度的情况下。</p>
<pre><code class="language-console">POST image-index/_search
{
  "knn": {
    "field": "image-vector",
    "query_vector": [1, 5, -20],
    "k": 5,
    "num_candidates": 50,
    "similarity": 36,
    "filter": {
      "term": {
        "file-type": "png"
      }
    }
  },
  "fields": ["title"],
  "_source": false
}
</code></pre>
<p>在我们的数据集中，唯一具有PNG文件类型的文档具有向量[42, 8, -15]。[42, 8, -15]与[1, 5, -20]之间的L2范数距离为41.412，大于配置的相似度36。这意味着此搜索将不会返回任何结果。</p>
<h4 id="nested-knn-search"><a class="header" href="#nested-knn-search">Nested kNN Search</a></h4>
<p>嵌套的KNN检索</p>
<p>通常文本会超出特定模型的 token 限制，并需要在构建各个块的嵌入（向量）之前进行分块。在使用嵌套结构和dense_vector时，可以实现最近段落检索，而无需复制顶层文档元数据。</p>
<pre><code class="language-console">PUT passage_vectors
{
    "mappings": {
        "properties": {
            "full_text": {
                "type": "text"
            },
            "creation_time": {
                "type": "date"
            },
            "paragraph": {
                "type": "nested",
                "properties": {
                    "vector": {
                        "type": "dense_vector",
                        "dims": 2,
                        "index": true,
                        "similarity": "cosine"
                    },
                    "text": {
                        "type": "text",
                        "index": false
                    }
                }
            }
        }
    }
}
</code></pre>
<h4 id="indexing-considerations"><a class="header" href="#indexing-considerations">Indexing considerations</a></h4>
<p>对于近似的 kNN 搜索，Elasticsearch 将每个段的密集向量值存储为 HNSW 图。由于构建这些图的成本很高，为了进行近似的 kNN 搜索，索引向量可能需要花费大量时间。您可能需要增加索引和批量请求的客户端请求超时时间。<a href="https://www.elastic.co/guide/en/elasticsearch/reference/8.11/tune-knn-search.html">approximate kNN tuning guide</a>  包含了关于索引性能和索引配置如何影响搜索性能的重要指导。</p>
<p>除了其  搜索时调整参数之外，HNSW 算法还具有在索引时间的参数，可以在构建图的成本、搜索速度和准确性之间进行权衡。在设置密集向量映射时，您可以使用 index_options 参数来调整这些参数。</p>
<pre><code class="language-console">PUT image-index
{
  "mappings": {
    "properties": {
      "image-vector": {
        "type": "dense_vector",
        "dims": 3,
        "index": true,
        "similarity": "l2_norm",
        "index_options": {
          "type": "hnsw",
          "m": 32,
          "ef_construction": 100
        }
      }
    }
  }
}
</code></pre>
<h4 id="limitations-for-approximate-knn-search"><a class="header" href="#limitations-for-approximate-knn-search">Limitations for approximate kNN search</a></h4>
<ol>
<li>When using kNN search in <a href="https://www.elastic.co/guide/en/elasticsearch/reference/8.11/modules-cross-cluster-search.html">cross-cluster search</a>, the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/8.11/modules-cross-cluster-search.html#ccs-min-roundtrips"><code>ccs_minimize_roundtrips</code></a> option is not supported.</li>
<li>Elasticsearch uses the <a href="https://arxiv.org/abs/1603.09320">HNSW algorithm</a> to support efficient kNN search. Like most kNN algorithms, HNSW is an approximate method that sacrifices result accuracy for improved search speed. This means the results returned are not always the true <em>k</em> closest neighbors.</li>
</ol>
<p>**注意：**近似的 kNN 搜索总是使用 dfs_query_then_fetch 搜索类型，以便在各个分片上收集全局前 k 个匹配项。在运行 kNN 搜索时，您不能显式设置 search_type。</p>
<h2 id="exact-knn"><a class="header" href="#exact-knn">Exact kNN</a></h2>
<blockquote>
<p>确定的KNN搜搜算法</p>
</blockquote>
<p>要运行精确的 kNN 搜索，请使用带有向量函数的 script_score 查询。</p>
<ol>
<li>明确定义一个或多个 dense_vector 字段。如果您不打算将该字段用于近似 kNN 搜索，则省略索引映射选项或将其设置为 false。这样可以显著提高索引速度。</li>
</ol>
<p><strong>使用流畅</strong></p>
<p>构建Mapping</p>
<pre><code class="language-console">PUT product-index
{
  "mappings": {
    "properties": {
      "product-vector": {
        "type": "dense_vector",
        "dims": 5,
        "index": false
      },
      "price": {
        "type": "long"
      }
    }
  }
}
</code></pre>
<p>索引数据</p>
<pre><code class="language-console">POST product-index/_bulk?refresh=true
{ "index": { "_id": "1" } }
{ "product-vector": [230.0, 300.33, -34.8988, 15.555, -200.0], "price": 1599 }
{ "index": { "_id": "2" } }
{ "product-vector": [-0.5, 100.0, -13.0, 14.8, -156.0], "price": 799 }
{ "index": { "_id": "3" } }
{ "product-vector": [0.5, 111.3, -13.0, 14.8, -156.0], "price": 1099 }
...
</code></pre>
<p>Use the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/8.11/search-search.html">search API</a> to run a <code>script_score</code> query containing a <a href="https://www.elastic.co/guide/en/elasticsearch/reference/8.11/query-dsl-script-score-query.html#vector-functions">vector function</a>.</p>
<p>为了限制传递给向量函数的匹配文档数量，我们建议您在 script_score.query 参数中指定一个过滤查询。如果需要，您可以在该参数中使用 match_all 查询来匹配所有文档。但是，匹配所有文档可能会显著增加搜索延迟。</p>
<pre><code class="language-console">POST product-index/_search
{
  "query": {
    "script_score": {
      "query" : {
        "bool" : {
          "filter" : {
            "range" : {
              "price" : {
                "gte": 1000
              }
            }
          }
        }
      },
      "script": {
        "source": "cosineSimilarity(params.queryVector, 'product-vector') + 1.0",
        "params": {
          "queryVector": [-0.5, 90.0, -10, 14.8, -156.0]
        }
      }
    }
  }
}
</code></pre>
<h2 id="近似knn调优"><a class="header" href="#近似knn调优">近似KNN调优</a></h2>
<p>Elasticsearch支持近似的k最近邻搜索，可以高效地找到查询向量的k个最近向量。由于近似kNN搜索与其他查询的工作方式不同，所以在性能方面有特殊考虑。</p>
<p>这些建议中的许多都有助于提高搜索速度。对于近似kNN，索引算法在后台运行搜索以创建向量索引结构。因此，这些相同的建议也有助于提高索引速度。</p>
<h3 id="prefer-dot_product-over-cosine"><a class="header" href="#prefer-dot_product-over-cosine">Prefer <code>dot_product</code> over <code>cosine</code></a></h3>
<blockquote>
<p>点积优先于cosin</p>
</blockquote>
<p>在为近似kNN搜索索引向量时，您需要指定用于比较向量的相似性函数。如果您想通过余弦相似性比较向量，有两个选项。</p>
<p>余弦选项接受任何浮点向量并计算余弦相似性。虽然这对测试很方便，但不是最有效的方法。相反，我们建议使用dot_product选项来计算相似性。要使用dot_product，所有向量都需要提前归一化为长度为1。dot_product选项要快得多，因为它在搜索过程中避免了执行额外的向量长度计算。</p>
<h3 id="ensure-data-nodes-have-enough-memory"><a class="header" href="#ensure-data-nodes-have-enough-memory">Ensure data nodes have enough memory</a></h3>
<blockquote>
<p>确保节点有足够多的内存</p>
</blockquote>
<ol>
<li>
<p>Elasticsearch使用HNSW算法进行近似kNN搜索。HNSW是一种基于图的算法，只有在大多数向量数据保存在内存中时才能有效工作。</p>
</li>
<li>
<p>您应确保数据节点至少有足够的RAM来保存向量数据和索引结构。要检查向量数据的大小，您可以使用Analyze index disk usage API。作为一个粗略的经验法则，并假设默认的HNSW选项，使用的字节数将是  num_vectors * 4 * (num_dimensions + 12)。当使用字节element_type时，所需的空间将更接近于num_vectors * (num_dimensions + 12)。请注意，所需的RAM是用于文件系统缓存的，这与Java堆是分开的。</p>
</li>
<li>
<p>数据节点还应为RAM需要的其他方式留出一些缓冲区。例如，您的索引可能还包括文本字段和数字字段，这些字段也受益于使用文件系统缓存。建议使用您的特定数据集运行基准测试，以确保有足够的内存来提供良好的搜索性能。您可以在这里和这里找到我们用于每晚基准测试的数据集和配置的一些示例。</p>
</li>
</ol>
<h3 id="warm-up-the-filesystem-cache"><a class="header" href="#warm-up-the-filesystem-cache">Warm up the filesystem cache</a></h3>
<blockquote>
<p>预热文件系统缓存</p>
</blockquote>
<p>如果运行Elasticsearch的机器重新启动，文件系统缓存将会被清空，因此在操作系统将索引的热点区域加载到内存中以便搜索操作变得快速之前会需要一些时间。您可以使用index.store.preload  设置显式地告诉操作系统应该根据文件扩展名急切地加载哪些文件到内存中。</p>
<p>在太多索引或太多文件上急切地将数据加载到文件系统缓存中，如果文件系统缓存不足以容纳所有数据，将会使搜索变慢。请谨慎使用。</p>
<p>以下文件扩展名用于近似kNN搜索："vec"（用于向量值），"vex"（用于HNSW图），"vem"（用于元数据）。</p>
<h3 id="reduce-vector-dimensionality"><a class="header" href="#reduce-vector-dimensionality">Reduce vector dimensionality</a></h3>
<blockquote>
<p>缩减向量维度</p>
</blockquote>
<p>kNN搜索的速度与向量维度的数量成正比，因为每个相似性计算都考虑两个向量中的每个元素。在可能的情况下，最好使用维度较低的向量。一些嵌入模型有不同的“大小”，提供了维度较低和较高的选项。您还可以尝试使用主成分分析等降维技术。在尝试不同方法时，重要的是要衡量对相关性的影响，以确保搜索质量仍然可接受。</p>
<h4 id="exclude-vector-fields-from-_source"><a class="header" href="#exclude-vector-fields-from-_source">Exclude vector fields from <code>_source</code></a></h4>
<blockquote>
<p>不保存 向量的_source</p>
</blockquote>
<p>Elasticsearch在索引时会将原始的JSON文档存储在_source字段中。默认情况下，搜索结果中的每个命中都包含完整的文档_source。当文档包含高维稠密向量字段时，_source可能会相当大且加载成本高。这可能会显著降低kNN搜索的速度。</p>
<p>您可以通过excludes映射参数禁用在_source中存储dense_vector字段。这可以防止在搜索期间加载和返回大向量，并减少索引大小。已从_source中省略的向量仍然可以用于kNN搜索，因为它依赖于单独的数据结构来执行搜索。在使用excludes参数之前，请确保审查省略_source字段的缺点。</p>
<p>另一个选择是如果您的所有索引字段都支持，则使用合成的_source。</p>
<h3 id="reduce-the-number-of-index-segments"><a class="header" href="#reduce-the-number-of-index-segments">Reduce the number of index segments</a></h3>
<blockquote>
<p>减小段大小</p>
</blockquote>
<p>Elasticsearch分片由段组成，段是索引中的内部存储元素。对于近似kNN搜索，Elasticsearch将每个段的向量值存储为单独的HNSW图，因此kNN搜索必须检查每个段。最近kNN搜索的并行化使得在多个段之间进行搜索变得更快，但如果段较少，kNN搜索仍然可能快几倍。默认情况下，Elasticsearch会定期通过后台合并过程将较小的段合并为较大的段。如果这不够用，您可以采取显式步骤来减少索引段的数量。</p>
<h4 id="force-merge-to-one-segment"><a class="header" href="#force-merge-to-one-segment">Force merge to one segment</a></h4>
<p>force merge操作会强制执行索引合并。如果您将force merge到一个段，kNN搜索只需检查一个包含所有内容的HNSW图。强制合并dense_vector字段是一项昂贵的操作，可能需要较长时间才能完成。</p>
<p>我们建议只对只读索引（即索引不再接收写入）执行force merge操作。当文档被更新或删除时，旧版本不会立即被移除，而是被软删除并标记为“墓碑”。这些软删除的文档会在常规段合并期间自动清理。但是force merge可能会导致产生非常大（&gt; 5GB）的段，这些段不符合常规合并的条件。因此，软删除文档的数量可能会迅速增加，导致磁盘使用量增加和搜索性能变差。如果您经常对接收写入的索引执行force merge操作，这也会使快照变得更加昂贵，因为新文档无法进行增量备份。</p>
<h3 id="create-large-segments-during-bulk-indexing"><a class="header" href="#create-large-segments-during-bulk-indexing">Create large segments during bulk indexing</a></h3>
<blockquote>
<p>在批量构建过程中给ES索引创建大段</p>
</blockquote>
<p>一个常见的模式是首先执行初始的批量上传，然后使索引可用于搜索。您可以调整索引设置，鼓励Elasticsearch创建更大的初始段，而不是进行force merge操作。</p>
<ol>
<li>确保在批量上传过程中没有搜索活动，并通过将index.refresh_interval设置为-1来禁用它。这可以防止刷新操作并避免创建额外的段。</li>
<li>给Elasticsearch一个大的索引缓冲区，这样它在刷新之前可以接受更多的文档。默认情况下，indices.memory.index_buffer_size设置为堆大小的10%。对于像32GB这样大的堆大小，这通常足够了。为了允许完整的索引缓冲区被使用，您还应该增加限制  index.translog.flush_threshold_size。</li>
</ol>
<h3 id="avoid-heavy-indexing-during-searches"><a class="header" href="#avoid-heavy-indexing-during-searches">Avoid heavy indexing during searches</a></h3>
<blockquote>
<p>避免在重度索引时，检索</p>
</blockquote>
<p>主动索引文档可能会对近似kNN搜索性能产生负面影响，因为索引线程会从搜索中夺取计算资源。当同时进行索引和搜索时，Elasticsearch也会频繁刷新，这会创建几个小的段。这也会影响搜索性能，因为当有更多的段时，近似kNN搜索会变慢。</p>
<p>如果可能的话，在进行近似kNN搜索时最好避免进行大量的索引操作。如果需要重新索引所有数据，也许是因为向量嵌入模型发生了变化，那么最好将新文档重新索引到一个单独的索引中，而不是就地更新它们。这有助于避免上述的减速，并且可以避免由于频繁的文档更新而导致昂贵的合并操作。</p>
<h3 id="avoid-page-cache-thrashing-by-using-modest-readahead-values-on-linux"><a class="header" href="#avoid-page-cache-thrashing-by-using-modest-readahead-values-on-linux">Avoid page cache thrashing by using modest readahead values on Linux</a></h3>
<p>在Linux上使用适度的预读取数值来避免页面缓存抖动。</p>
<p>搜索可能导致大量随机读取I/O。当底层块设备具有较高的预读取值时，可能会进行大量不必要的读取I/O，特别是在使用内存映射访问文件时（(see <a href="https://www.elastic.co/guide/en/elasticsearch/reference/8.11/index-modules-store.html#file-system">storage types</a>).）。</p>
<p>大多数Linux发行版对于单个普通设备使用了合理的预读取值，为128KiB，然而，当使用软件RAID、LVM或dm-crypt时，生成的块设备（支持Elasticsearch path.data）可能会具有非常大的预读取值（在几MiB的范围内）。这通常会导致严重的页面（文件系统）缓存抖动，从而对搜索（或更新）性能产生不利影响。</p>
<p>你可以使用 lsblk -o NAME,RA,MOUNTPOINT,TYPE,SIZE 命令来检查当前的值（以KiB为单位）。请参考您所使用的发行版的文档，了解如何修改此值（例如，使用udev规则以在重新启动后保持持续性，或者使用 blockdev --setra 作为临时设置）。我们建议将预读取值设为128KiB。</p>
<p>blockdev命令期望以512字节扇区为单位的值，而lsblk命令报告的值是以KiB为单位的。例如，要临时将/dev/nvme0n1的预读取设置为128KiB，可以指定blockdev --setra 256 /dev/nvme0n1。</p>
<script src="/note-service/db/infisearch_assets/search-ui.chinese.bundle.js" type="text/javascript" charset="utf-8"></script>
<script src="/note-service/db/infisearch_assets/mark.min.js" type="text/javascript" charset="utf-8"></script>
<script>
const base_url = '/note-service/db/';
const mode = 'target';
infisearch.init({
  searcherOptions: {
    url: base_url + 'infisearch_output/',
  },
  uiOptions: {
    mode,
    dropdownAlignment: 'bottom-start',
    target: document.getElementById('infisearch-mdbook-target'),
    fsButtonPlaceholder: 'Search',
    sourceFilesUrl: base_url,
    resultsRenderOpts: {
      searchedTermsParam: 'search',
    },
    multiSelectFilters: [
      { fieldName: 'partTitle', displayName: 'Section', defaultOptName: 'None' },
    ],
  },
});

document.getElementById('infi-search').addEventListener('keydown', (ev) => {
  if (['ArrowLeft', 'ArrowRight'].includes(ev.key)) {
    ev.stopPropagation(); // used in global listener to change pages
    return;
  }
});

if (window.location.search) {
  // Adapted from the original searcher.js for mdbook
  // https://github.com/rust-lang/mdBook/blob/master/src/theme/searcher/searcher.js
  const target = document.getElementById('content');
  const marker = new Mark(target);

  function doSearchOrMarkFromUrl() {
    // Check current URL for search request
    var url = new URL(window.location.href);
    var urlParams = new URLSearchParams(url.search);

    if (urlParams.has('search')) {
      var words = JSON.parse(decodeURIComponent(urlParams.get('search')));
      marker.mark(words);

      var markers = document.querySelectorAll('mark');
      function hide() {
        for (var i = 0; i < markers.length; i++) {
          markers[i].classList.add('fade-out');
          window.setTimeout(function () { marker.unmark(); }, 300);
        }
      }
      for (var i = 0; i < markers.length; i++) {
        markers[i].addEventListener('click', hide);
      }
    }
  }
  doSearchOrMarkFromUrl();
}
</script>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../elasticSearch/9.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../elasticSearch/BackUpACluster.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../elasticSearch/9.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../elasticSearch/BackUpACluster.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>



        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
